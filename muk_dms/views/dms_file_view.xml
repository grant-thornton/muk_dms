<?xml version="1.0" encoding="UTF-8"?>
<!--     
	Copyright (C) 2017 MuK IT GmbH
	
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>. 
-->
<odoo>
	<record id="view_dms_file_kanban" model="ir.ui.view">
		<field name="name">muk_dms_file.kanban</field>
		<field name="model">muk_dms.file</field>
		<field name="arch" type="xml">
			<kanban js_class="dms_file_kanban">
				<field name="name"/>
				<field name="thumbnail"/>
				<templates>
					<t t-name="kanban-box">
						<div class="muk_kanban_file">
							<div class="muk_image text-center" t-attf-data-id="#{record.id.value}">
								<img t-attf-src="data:image/*;base64,{{record.thumbnail.value}}"/>
							</div>
							<div class="muk_filename text-center" t-attf-data-id="#{record.id.value}">
								<t name="name" t-esc="record.name.value"/>
							</div>
						</div>
					</t>
				</templates>
			</kanban>
		</field>
	</record>
	<record id="view_dms_file_tree" model="ir.ui.view">
		<field name="name">muk_dms_file.tree</field>
		<field name="model">muk_dms.file</field>
		<field name="arch" type="xml">
			<tree string="Files">
				<field invisible="1" name="locked"/>
				<field invisible="1" name="perm_create"/>
				<field invisible="1" name="perm_write"/>
				<field invisible="1" name="perm_unlink"/>
				<field invisible="1" name="code"/>
				<field name="abbreviation_code"/>
				<field name="name"/>
				<field name="mimetype"/>
				<field name="size" widget="dms_size"
					groups="muk_dms.group_dms_manager"/>
				<field name="write_date" string="Odoo write_date"/>
				<field name="path" widget="dms_path"
					groups="muk_dms.group_dms_manager"/>
			</tree>
		</field>
	</record>
	<record id="view_dms_file_form" model="ir.ui.view">
		<field name="name">muk_dms_file.form</field>
		<field name="model">muk_dms.file</field>
		<field name="arch" type="xml">
			<form string="Files">
				<header>
					<button attrs="{'invisible':['|',('locked', '!=', False), ('perm_write', '=', False)]}" class="oe_highlight" name="user_lock" string="Lock (Edit)" type="object"/>
					<button attrs="{'invisible':['|',('locked', '=', False), ('editor', '=', False)]}" class="oe_highlight" name="user_unlock" string="Unlock (Release)" type="object"/>
				</header>
				<sheet>
					<div class="oe_button_box" name="button_box">
						<button class="oe_stat_button" confirm="(Un)archiving the file. Do you want to proceed?" icon="fa-archive" name="toggle_active" type="object">
							<field name="active" options="{&quot;terminology&quot;: &quot;archive&quot;}" widget="boolean_button"/>
						</button>
					</div>
					<field invisible="1" name="locked"/>
					<field invisible="1" name="editor"/>
					<field class="oe_avatar oe_read_only" name="thumbnail" options="{'size': [90, 90]}" widget="image"/>
					<field class="oe_avatar oe_edit_only" name="custom_thumbnail" options="{'size': [90, 90]}" widget="image"/>
					<div class="oe_title">
						<h3>
							<field filename="name" name="content"/>
						</h3>
						<label class="oe_edit_only" for="name"/>
						<h1>
							<field name="name"/>
						</h1>
					</div>
					<group>
						<field name="relational_path" widget="dms_relpath"/>
						<field invisible="True" name="code" readonly="True"/>
						<field name="abbreviation_code" readonly="True"/>
					</group>
					<group>
						<group string="Data">
							<field name="size" widget="dms_size"/>
							<field name="origin"/>
							<field groups="muk_dms.group_dms_manager" name="extension"/>
							<field groups="muk_dms.group_dms_manager" name="mimetype"/>
						</group>
						<group string="Settings">
							<field groups="muk_dms.group_dms_admin" name="settings"/>
							<field name="directory"/>
						</group>
					</group>
					<notebook>
						<page groups="muk_dms.group_dms_admin" string="Access Information">
							<group>
								<group>
									<field name="perm_read" readonly="1"/>
								</group>
								<group>
									<field name="perm_create" readonly="1"/>
									<field name="perm_write" readonly="1"/>
									<field name="perm_unlink" readonly="1"/>
								</group>
							</group>
						</page>
						<page groups="muk_dms.group_dms_user" name="meta_info" string="Meta Information">
							<group name="extra_info">
								<group name="misc" string="Misc.">
									<field name="create_date" readonly="1"/>
									<field name="create_uid" options="{'no_open': True}" readonly="1"/>
									<field name="write_date" readonly="1"/>
									<field name="write_uid" options="{'no_open': True}" readonly="1"/>
									<field groups="muk_dms.group_dms_admin" name="id" readonly="1"/>
									<field groups="muk_dms.group_dms_admin" name="locked_by"/>
								</group>
								<group groups="muk_dms.group_dms_manager" name="access_info" string="Access Information">
									<field name="perm_read" readonly="1"/>
									<field name="perm_create" readonly="1"/>
									<field name="perm_write" readonly="1"/>
									<field name="perm_unlink" readonly="1"/>
								</group>
							</group>
						</page>
						<page groups="muk_dms.group_dms_admin" string="Technical Information">
							<group>
								<field name="reference"/>
							</group>
							<group string="Indexed Content">
								<field name="index_content" nolabel="1"/>
							</group>
						</page>
						<page name="extra_info" string="Extra Information">
							<field name="description"/>
						</page>
					</notebook>
				</sheet>
			</form>
		</field>
	</record>
	<record id="view_dms_file_search" model="ir.ui.view">
		<field name="name">muk_dms.file.search</field>
		<field name="model">muk_dms.file</field>
		<field name="arch" type="xml">
			<search string="Files">
				<field name="name"/>
				<field name="code"/>
				<field name="relational_path"/>
				<group expand="0" string="Group By"/>
			</search>
		</field>
	</record>
	<record id="action_dms_file" model="ir.actions.act_window">
		<field name="name">Document Files</field>
		<field name="res_model">muk_dms.file</field>
		<field name="view_mode">kanban,tree,form</field>
	</record>
</odoo>